# OpenConnect Server Configuration
# Enhanced for SSL certificate management

# Authentication method
auth = "plain[passwd=/etc/ocserv/ocpasswd]"

# TCP and UDP port number  
tcp-port = 4443
udp-port = 4443

# The user the worker processes will be run as
run-as-user = nobody
run-as-group = users

# socket file used for IPC with occtl
socket-file = /var/run/ocserv-socket

# The key and the certificates of the server
server-cert = /etc/ocserv/certs/server-cert.pem
server-key = /etc/ocserv/certs/server-key.pem

# The Certificate Authority that will be used to verify client certificates
ca-cert = /etc/ocserv/certs/ca.pem

# Whether to enable seccomp/Linux namespaces worker isolation
isolate-workers = true

# Limit the number of clients. Unset or set to zero for unlimited
max-clients = 0

# Limit the number of identical clients
max-same-clients = 10

# Stats reset time (weekly: 604800 seconds)
server-stats-reset-time = 604800

# Keepalive in seconds
keepalive = 32400

# Dead peer detection in seconds
dpd = 90

# Dead peer detection for mobile clients
mobile-dpd = 1800

# Switch to TCP timeout
switch-to-tcp-timeout = 25

# MTU discovery (DPD must be enabled)
try-mtu-discovery = false

# Certificate user OID
cert-user-oid = 0.9.2342.19200300.100.1.1

# Compression negotiation
compression = true

# Minimum size under which a packet will not be compressed
no-compress-limit = 256

# GnuTLS priority string
tls-priorities = "NORMAL:%SERVER_PRECEDENCE:%COMPAT:-VERS-SSL3.0"

# Authentication timeout
auth-timeout = 240

# Minimum reauth time
min-reauth-time = 300

# Ban score settings
max-ban-score = 80
ban-reset-time = 1200

# Cookie timeout
cookie-timeout = 300

# Whether roaming is allowed
deny-roaming = false

# ReKey time and method
rekey-time = 172800
rekey-method = ssl

# Scripts to call on connect/disconnect
connect-script = /etc/ocserv/connect.sh
disconnect-script = /etc/ocserv/disconnect.sh

# Whether to enable support for the occtl tool
use-occtl = true

# PID file
pid-file = /var/run/ocserv.pid

# Network settings
device = vpns
predictable-ips = true
default-domain = vpn.example.com

# IPv4 network configuration
ipv4-network = 192.168.255.0
ipv4-netmask = 255.255.255.0

# DNS servers (will be updated by entrypoint script)
dns = 8.8.8.8
dns = 8.8.4.4

# Whether to ping leases before assignment
ping-leases = false

# AnyConnect client compatibility
cisco-client-compat = true
dtls-legacy = true

# Per-user and per-group configuration directories
#config-per-user = /etc/ocserv/config-per-user/
#config-per-group = /etc/ocserv/config-per-group/